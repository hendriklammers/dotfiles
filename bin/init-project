#!/bin/bash
#
# Starts a new project

PS3='Project type: '
select opt in Elm Node
do
  case $opt in
    "Elm")
      projectType="elm"
      break
      ;;
    "Node")
      projectType="node"
      break
      ;;
    *) echo "invalid option $REPLY";;
  esac
done

while [ -z "$projectTitle" ]
do
  read -p "Project title: " input;
  if [[ ! "$input" =~ ^[a-zA-Z0-9-]{3,}$ ]]; then
    echo "Invalid project title";
  elif [ -d "$input" ]; then
    echo "Directory with this title already exists";
  else
    projectTitle="$input"
  fi
done

read -p "Project description: " projectDescription;

mkdir -p "$projectTitle"
cd "$projectTitle"

case "$projectType" in
  "elm")
    repo=git@github.com:hendriklammers/elm-project.git
    ;;
  "node")
    repo=git@github.com:hendriklammers/node-project.git
    ;;
  *) echo "No repo available for this project type"; exit 1
esac
git clone "$repo" .

# TODO: See if something like this would be better:
# https://github.com/thoughtbot/dotfiles/blob/master/bin/replace
#
# Add title and description to package.json and index.html
# sed -i"" "s/PROJECT_TITLE/$title/g; s/PROJECT_DESCRIPTION/$description/g;"\
#   package.json \
#   public/index.html \
#   README.md

# Remove .git directory, we want to start with a clean repo
# if [ -d ".git" ]; then
#   rm -rf .git
# fi

# TODO: Add option to also create a new repo on Github
# Initialize new git repo and add everything
git init && git add . && git commit -m "Initial commit"
